<link rel="import" href="../../elements/kct-view/kct-view.html">
<link rel="import" href="../../elements/kct-pages/kct-pages.html">
<link rel="import" href="settings-index-page.html">
<link rel="import" href="settings-group-page.html">

<dom-module id="settings-page">
    <template>
        <style>
            :host { display: block;  }    
        </style>

        <kct-pages id="pages" selected="[[ page ]]" attr-for-selected="name" on-itemactivate="__onPageActivate">
            <settings-index-page name="index" route="{{ route }}" height="[[ height ]]" state="[[ state ]]" user="[[ user ]]"></settings-index-page>
            <settings-group-page name="group" route="{{ route }}" width="[[ width ]]" height="[[ height ]]" config="{{ config }}" state="[[ state ]]" user="[[ user ]]"></settings-group-page>
        </kct-pages>

    </template>
    <script>

        class SettingsPage extends KctView {    
            static get is() {
                return 'settings-page';
            }

            static get properties() {
                return {
                    title: { type: String, notify: true, value: 'Settings' },
                    page: { type: String, value: 'index' },
                    height: { type: Number },
                    width: { type: Number }
                };
            }

            static get observers() {
                return [
                    '__stateChanged(state.*)'
                ];
            }

            handleResizing(width, height) {
                this.set('height', height);
                this.set('width', width);
            }

            __stateChanged(changed) {
                let module = this.state.module;
                if (module == 'settings') {
                    if (this.state.setting) {
                        if (this.get('page') != 'group') {
                            (this.set('page', 'group'));  
                        }
                    } else {
                        this.set('page', 'index');
                    }
                }
            }

            __onPageActivate(e) {
                let pageNode = e.detail.activeItem;
                if (pageNode && pageNode.activate) {
                    pageNode.activate();
                }
            }
        }

        customElements.define(SettingsPage.is, SettingsPage);
    </script>
</dom-module>